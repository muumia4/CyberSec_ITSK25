Andmete omadused
CIA = Confidentiality (andmed on hoitud privaatsetena ja kaitstuna), Integrity (Andmed on kaitstud volitamata muutmise eest), Availability (Andmed on kättesaadavad neile kel ja kui vaja)
Intsident = tõeline või arvatav, soovimatu või ootamatu, loomult kuridetelik või mitte, infoturvarike või sündmus või nende sari, mis võib kahjustada äritegevust või ähvardada teabe turvalisust. 
Rünne = motivatsion (eesmärk) + meetod + nõrkus
Oht = Soovimatu sündmuse võimalik esinemine, mis võib kahjustada organisatsiooni tegevust
Oht + Nõrkus = Risk
Näiteks:
  Süsteemi(de) nakatumine luna- või pahavaraga
  Süsteemi volitamata kasutamine
  Teenusetõkestusrünnak
  Veebilehe näostamine
  Andmete vargus

Ohumärgid mis viitavad intsidendi toimumisele tulevikus
  Süsteemide skanneerimine
  Vestlused darkwebi foorumites
  Uute turvanõrkuste avalikustamine

Indikaatorid mis viitavad, et intsident on toimunud või toimumas
  Kasutajate pöördumised
  Süsteemide ebatavaline käitumine (ressursikasutus, ebastabiilsus)
  Suurenenud võrguliikluse mahud
  Kahtlased võrguühendused
  Tulemüüri sessioonitabeli täitumine

Ohusubjekt (Threat Actor)
  Skriptinagad (script kiddies)
  Kinnisründeoht (APT Advanced Persistent Threat)
  Häktivism
  Siseringioht (insider threat)

Intsidendi kulu koosneb otsestest ja kaudsetest kahjudest
  Otsesed
    Tegevusseisak
    Rahaline kahju (lunaraha)
    Juriidilised ja seadusandlikud probleemid (NIS2, GDPR trahvid)
    Intsidendi menetluse kulud
  Kaudsed
    Andmete konfidentsiaalsuse, terviklikuse ja käideldavuse kadu
    Mainekahju
    Klientide usalduse kadu

Ründaja saab infot näiteks töökuulutuste kaudu
Kasutatakse õngitsuskirju

Intsidendihaldus = Selgelt defineeritud protseduuride kogum intsidentide käsitlemiseks arvuti- ja võrgusüsteemides
  Aidata organisatsiooni kiirelt ja effektiivselt ning minimaalsete kahjudega taastada süsteemide talituspidevus
  Minimiseerida võimalikud kahjud, mis võivad tekkida andmete vargusest või kaost ning kriitiliste süsteemide talituspidevuse katkemisest
  Viia ellu süstemaatiline vastutegevus järgides valdkonna parimaid praktikaid
  Vältida sarnaste intsidentide kordumist tulevikus
  Aidata organisatsioonil taaskaalustada turbenõudeid finantskulutustega
  Täita regulatiivseid nõudeid (NIS2, EITS, GDPR, ISO vms)

PICERL = Intsidendi lahendamise protsess
DAIR = Dynamic approach to incident response

Regulatsioonid
  NIST SP800-61R3
    Incident Responce Recommandations and Considerations for Cybersecurity Risk Management
  E-ITS - DER (https://eits.ria.ee/et/versioon/2024/eits-poohidokumendid/etalonturbe-kataloog/der-avastamine-ja-reageerimine/der1-turvaintsidentide-avastamine/3-meetmed)
    Avastamine ja reageerimine
    DER.1 Turvaintsidentide lahendamine
    DER
  ISO 27035
    Information Security Indicent Management

Üldpõhimõtted
  Intsidendi lahendamise käigus tuleb arvestada organisatsiooni väärtusahela kaitset. Intsidendi lahendamise eesmärgiks on esmajoones vältida ründe levimist ärikriitilistesse süsteemidesse või ärikriitiliste süsteemide talituspidevuse taastamine.
    Ärikriitiliste teenuste sulgemine tuleb viia läbi kaalutletult ning kooskõlastatult ettevõtte juhtkonnaga.
  Intsidendi kommunikatsioon väliste osapooltega peab olema kaalutletud ning kooskõlastatud organisatsiooni kommunikatsioonijuhiga.
  Lisaks intsidendi mõju kiirele piiritlemisele, on esmajärjekorras oluline teha kindlaks võimalik andmeleke ja selle ulatus, kuna andmete lekkimine võib põhjustada ...?

Intsidendi eduka lahendamise eelduseks on korralik ettevalmistus mis hõlmab:
  Poliitika ja plaani väljatöötamisega
  Protseduuride väljatöötamist
  Töövahendite ettevalmistust, testimist ja koolitusi
  Ennetavate ja tuvastavate tehnoloogiate juurutamist

Intsidendi käsitlemise plaan
  Joondatud asutuse turvapoliitkaga
  Testitud õppuse käigus
  Joondatud asutuse tegevuskeskkonnaga, riskide ja kriisiplaaniga

Tehnoloogiad ja dokumentatsioon
  Logiserver/SIEM koos analüütikareeglitega, et koguda ja edastada logisid
  IDS/IPS/NDR koos vajaliku riistvaraga
  Puhtad süsteemitõmmised (kuldpildid) ning tarkvaratõmmiste masspaigalduseks
  Lühiteatmelehed (spikrid) töövahendite kasutamiseks
  Kommunikatsiooni plaanid ja juhised intsidendi ajal suhtluse korraldamiseks
  Intsidendi dokumentatsiooni põhjad
  Juhtkonna aruande põhjad
  Pressiteate põhi
  Arhidektuuri ja võrguskeemid

Tehnoloogiad
  SIEM
    Security Onion
    Wazuh
    ELK
    QRadar
    Graylog
  NDR/IDS
    Security Onion
    Zeek
    Suricata
  EDR Endpoint Detection and Response
    Sysmon
    Security Onion
    Wazuh
    OpenEDR
Turvaseirekeskus (SOC)

Tuvastamine
  Sündmused mis osutavad võimalikule intsidendile
    SIEM või Logisüsteemi teavitus
    Viirusetõjre teavitus
    Lõppkasutaja pöördumine
    Välise osapoole (CERT Eesti või ISP) pöördumine
    Lunaraha nõue seadmes
    Jne
  Kas tegemist on intsidengiga või mitte pole alati koheselt selge
  Kui palju süsteeme on mõjutatud?
  Kas kriitilised süsteemid mõjutatud?
  Kas kriitilised andmed mõjutatud?
  Kas on mõju organisatsiooni talituspidevusele?
  Kas kaasneb SLA-de või seaduse rikkumine?
  Mis tüüpi ründega tegu?
  Üks kriitiline süsteem > mitu ebaolulist

Meeskond
  Intsidendi juht - igale intsidendile määratakse intsidendi juuht tagamaks intsidendi organiseeritud ja kordineeritud lahendamise
  Tehniline
    Turvaanalüütikud
    Süsteemiadministraatorid
    IT tugi
    Turbeinsenerid
    Küberkriminalistika ekspert
  Äri
    Juhtkonna esindaja
    Infoturbejuht
    Jurist
    Kommunikatsioonijuht
    Peronalijuht

nalüüs
  Analüüsi faasis kogutakse vajalikud asitõendid edasiseks lahendamiseks. Eesmärgiks on tuvastada ulatus ja mõju ning juurpõhjus
  Analüüsi faas peab olema teostatud piisava põhjalikusega enne intsidendi käsitlemise järgmisse faasi minekut

  Analüüsitakse süsteemi logid
  Vajadusel seadistatakse logiserver või täiendatakse logianalüütikat ning suurendatakse logide detailsust

Ohjeldamine
  Juhtserverite IP aadresside, DNS nimede blokeerimine
  Kommutaatorite portide välja lülitamine
  Nakatunud seadmete võrgukaabli lahti ühendamine
  Liikluse piiramine tulemüüriga
  Liikluse kiiruse ja mahu piiramine
  Seadme isoleerimine eraldi VLANi
  Kasutajakontode paroolide vahetamine või kontode keelamine
  Teenuste keelamine
  Turvanõrkuste paikamine
  Honeypotide ja Canarytokenite paigaldamine taristusse
Ohjeldamise faasis on oluline arvestada intsidendi võimaliku mõju ning ulatusega. Ohjeldamise tegevused viiakse läbi vastavalt tajutavale riskitasemele. Ohjeldamise strateegia sõltub:
  Võimalikust kahjust ning andmete varguse tõenäosusest
  Vajadusest säilitada asitõendeid (süsteemi väljalülitamisel hävineb lendandmed RAMist)
  Teenuse käideldavuse nõuetest
  Strateegia rakendamise ajast
  Strateegia rakendamise ulatusest (osaline ohjeldamine, täielik ohjeldamine)
  Ohjeldamise tegevuse ajalisest mõjust (ajutised muutused, püsimuutused)

Väljajuurimine ja taastamine
  Pärast ohjeldusmeetmete rakendamist viiakse läbi tegevused ründaja süsteemidest väljaajamiseks
  Enne taastamistegevuste lõpule viimist tuleb veenduda, et ründe juurpõhjus on välja selgitatud
  Taastamine toimub lühikeses ja pikas perpektiivis- esmalt kriitilised süsteemid ning tagatakse turbetaseme kiire tõstmine ning äri talituspidevuse jätkumine; seejärel tegeletakse süsteemiarhidektuuri probleemidega
  Konsulteeritakse äri talituspidevuse- ja taasteplaaniga ning viiakse neile vastavalt läbi taastetegevused
  Pahavara eemaldamine süsteemidest
  Parema viirusetõrje/EDRi paigaldus
  Paroolide vahetus (sh kerberose kontod)
  PAM lahenduse paigaldamine
  Uute domeenikontrollerite paigaldamine
  Andmete taastamine varundusest
  
19.11.25
Kodutöö!!!
Pahavara kasutatakse enamasti ründe algul ja lõpus (ligipääsu saamine ja lunavara läiteks)
SEO mürgitamine / malvertising = otsingumootori tulemuste muutmine
Sihitud rünnakud = kliendispetsiifiline taristu
Rünnakud tehakse enamasti pilveteenustelt ja kuna nende IPd on legitiimsed siis on blokeerida ja tuvastada väga raske või võimatu.
Populaarsed ründevektorid on Powershell, CMD, WMI, CLR (Common language runtime).
Failita pahavara süstib ennast otse mällu ja ei salvesta kettale midagi.
Näiteks kood tõmmatakse powershelliga alla ja kompelleeritakse masinas otse mällu.
Powershell without powershell ründed = Kuna powershell ei ole tegelikult exe vaid dll siis seda saab laadidu teistesse tarkvaradesse sisse
Powershelli flage saab lühendada nii palju kuni see on ainuke valik (-NoP / -NoProfile)
Failinimi ei võrdu rakendus. Ründajad nimetavad ümber süsteemi rakendussi kui ka kolmandate osapoolte rakendusi
Protsessi sisemine = rakendus

Esmareageerija põhimõtted
Esmareageerija = Esimene inimene kes alustab intsidendiga tegelemist (IT spets, Sysadm), kindlustab sündmuspaiga ja tagab asitõendite puutumatuse
Ära satu paanikasse
Tegutse mõistlikult vastavalt olukorrale
Kogu esmane info juhtunu kohta (mis juhtus, mis tüüpi intsidendiga on tegu)
Juhtumi korral ära taaskäivita arvutit (krüpteerijad võivad mitu korda krüpteerida). Voolu välja tõmbamine võib aidata.
Kui on arvuti sees siis ära lülita välja, kui on väljas siis ära lülita sisse
Väljalülitamisel juhe seinast välja
Eemalda võrguliides, võrgukaabel
Kellaaeg ja ajavöönd kirja
Kui on vaja süsteemis midagi teha siis salvesta kõk tegevused (filmi ekraani, tee pilte)
Vajadusel teavita infoturvet, juhtkonda

Süsteemi analüüs
Esimesena pane käima MagnetForensics Magnet Response
FTK Imager teeb biti tasemel kettatõmmise (AFF või E0?)
Redline (veidi aegunud)
Ära logi nakatunud masinasse priviligeeritud domeeni kontoga
Me ei usalda ühtegi nakatumiskahtlusega masina tarkvara
Kui logid kustutatud siis vaatame shadowcopyst või backupist

Kui pihta saanud masinaid on mitu on analüüs keerulisem
Virustotalis tasub esimesena otsida räsi järgi kuna ründaja võib näha, et sa skanneerid tema viirust
Red Flags:
  Enamus pahavara on 32bit
  Stringis VBOX draiverid (pestudio)
  Kahtlased Autorunnid (sysinternals Autoruns)
  Puudulik cert
  Puudulik firma nimi või mõni muu sarnane lahter
  Event 1102
